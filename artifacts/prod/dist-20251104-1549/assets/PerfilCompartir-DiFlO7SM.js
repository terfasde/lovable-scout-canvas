import{r as i,j as e,a8 as w,U as y,ac as m,ad as k,q as C,ae as P}from"./vendor-react-BgpSLK3q.js";import{c as p,u as S,g as E,B as x,A as _,q as L}from"./index-wTsEScI4.js";import{J as f,K as U}from"./vendor-radix-B3dsqebR.js";import{L as q}from"./label-Ctiaxs-G.js";import{a as A,s as T}from"./api-otDnumpN.js";import{k as $}from"./vendor-MRMtI2Il.js";import"./vendor-supabase-DQanAYxp.js";import"./vendor-router-VbqrkW3a.js";import"./vendor-style--X5BZniO.js";import"./vendor-query-DDnmq2va.js";const h=i.forwardRef(({className:o,...c},r)=>e.jsx(f,{className:p("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",o),...c,ref:r,children:e.jsx(U,{className:p("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));h.displayName=f.displayName;const M=()=>{const[o,c]=i.useState(!0),[r,b]=i.useState(null),[t,n]=i.useState(!1),[g,d]=i.useState(!1),u=$(),{toast:l}=S();i.useEffect(()=>{(async()=>{try{const s=await E();if(!s){u("/auth");return}const a=await A(s.id).catch(()=>null);b(a??null),a?.is_public!==void 0&&n(!!a.is_public)}catch(s){l({title:"Error",description:s?.message||"No se pudo cargar el perfil",variant:"destructive"})}finally{c(!1)}})()},[]);const v=async s=>{if(r){d(!0);try{await T(r.user_id,s),n(s),l({title:s?"üåç Perfil p√∫blico":"üîí Perfil privado",description:s?"Tu perfil ahora es visible para todos":"Tu perfil ahora es privado"})}catch(a){l({title:"Error",description:a?.message||"No se pudo cambiar la visibilidad",variant:"destructive"})}finally{d(!1)}}},j=async()=>{if(!r)return;const s=`${window.location.origin}/perfil/public/${r.user_id}`;try{await navigator.clipboard.writeText(s),l({title:"‚úÖ Enlace copiado",description:"El enlace de tu perfil se copi√≥ al portapapeles"})}catch{l({title:"Error",description:"No se pudo copiar el enlace",variant:"destructive"})}},N=s=>{const a=s.trim().split(" ");return a.length>=2?`${a[0][0]}${a[1][0]}`.toUpperCase():s.substring(0,2).toUpperCase()};return o?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"h-20"}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})})]}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"h-20"}),e.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx(x,{variant:"ghost",size:"icon",onClick:()=>u("/perfil"),children:e.jsx(w,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Compartir perfil"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Controla qui√©n puede ver tu informaci√≥n"})]})]}),e.jsxs("div",{className:"bg-card border rounded-xl p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx(_,{className:"w-20 h-20",children:e.jsx(L,{className:"text-2xl font-semibold bg-primary text-primary-foreground",children:r?.nombre_completo?N(r.nombre_completo):e.jsx(y,{className:"w-10 h-10"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-semibold",children:r?.nombre_completo||"Usuario Scout"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r?.telefono||"Sin tel√©fono"})]})]}),e.jsx("div",{className:"bg-muted/50 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[t?e.jsx(m,{className:"w-5 h-5 text-primary"}):e.jsx(k,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"public-toggle",className:"text-base font-medium cursor-pointer",children:t?"Perfil p√∫blico":"Perfil privado"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t?"Cualquiera con el enlace puede ver tu perfil":"Solo t√∫ puedes ver tu perfil"})]})]}),e.jsx(h,{id:"public-toggle",checked:t,onCheckedChange:v,disabled:g})]})}),t&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted/50 rounded-lg",children:[e.jsx(C,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("code",{className:"flex-1 text-sm truncate",children:`${window.location.origin}/perfil/public/${r?.user_id}`}),e.jsxs(x,{size:"sm",variant:"outline",onClick:j,className:"gap-2 shrink-0",children:[e.jsx(P,{className:"w-4 h-4"}),"Copiar"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Comparte este enlace con otros scouts"})]})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-900 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-medium mb-2 flex items-center gap-2",children:[e.jsx(m,{className:"w-4 h-4"}),"Acerca de los perfiles p√∫blicos"]}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1 ml-6 list-disc",children:[e.jsx("li",{children:"Los perfiles p√∫blicos pueden ser vistos por cualquier persona con el enlace"}),e.jsx("li",{children:"Tu informaci√≥n de contacto se mostrar√° si el perfil es p√∫blico"}),e.jsx("li",{children:"Puedes volver a hacer privado tu perfil en cualquier momento"})]})]})]})]})};export{M as default};
