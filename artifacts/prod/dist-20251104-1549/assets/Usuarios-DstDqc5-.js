import{r as n,j as e,p as Te,g as as,ah as ts,t as rs,ai as ls,aj as is,X as ve,ak as Ne,a1 as ns,ag as Y,al as os,J as cs}from"./vendor-react-BgpSLK3q.js";import{c as w,i as C,b as _,s as f,p as ds,u as ms,g as us,B as h,C as B,a as L,U as A,D as be,r as we,d as ye,f as Ce,h as _e}from"./index-wTsEScI4.js";import{I as Z}from"./input-mWpG_fYx.js";import{N as hs,Q as xs,U as Ee,W as ps,X as gs,Y as Pe,Z as fs,_ as Ge,$ as js,a0 as vs,a1 as ke,a2 as Ue,a3 as De,a4 as ze}from"./vendor-radix-B3dsqebR.js";import{l as Ns,B as K,c as bs,a as ws,j as ys}from"./groups-CIRwBm-T.js";import{T as Cs,a as _s,b as ee,c as se}from"./tabs-BupnlxSv.js";import{T as Se}from"./textarea-C7PlNZJe.js";import{k as Ss}from"./vendor-MRMtI2Il.js";import"./vendor-supabase-DQanAYxp.js";import"./vendor-router-VbqrkW3a.js";import"./vendor-style--X5BZniO.js";import"./vendor-query-DDnmq2va.js";const ae=hs,te=xs,F=n.forwardRef(({className:t,children:l,...i},m)=>e.jsxs(Ee,{ref:m,className:w("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...i,children:[l,e.jsx(ps,{asChild:!0,children:e.jsx(Te,{className:"h-4 w-4 opacity-50"})})]}));F.displayName=Ee.displayName;const Ie=n.forwardRef(({className:t,...l},i)=>e.jsx(ke,{ref:i,className:w("flex cursor-default items-center justify-center py-1",t),...l,children:e.jsx(ts,{className:"h-4 w-4"})}));Ie.displayName=ke.displayName;const Re=n.forwardRef(({className:t,...l},i)=>e.jsx(Ue,{ref:i,className:w("flex cursor-default items-center justify-center py-1",t),...l,children:e.jsx(Te,{className:"h-4 w-4"})}));Re.displayName=Ue.displayName;const $=n.forwardRef(({className:t,children:l,position:i="popper",...m},d)=>e.jsx(gs,{children:e.jsxs(Pe,{ref:d,className:w("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",i==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:i,...m,children:[e.jsx(Ie,{}),e.jsx(fs,{className:w("p-1",i==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:l}),e.jsx(Re,{})]})}));$.displayName=Pe.displayName;const Ts=n.forwardRef(({className:t,...l},i)=>e.jsx(De,{ref:i,className:w("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...l}));Ts.displayName=De.displayName;const x=n.forwardRef(({className:t,children:l,...i},m)=>e.jsxs(Ge,{ref:m,className:w("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),...i,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(js,{children:e.jsx(as,{className:"h-4 w-4"})})}),e.jsx(vs,{children:l})]}));x.displayName=Ge.displayName;const Es=n.forwardRef(({className:t,...l},i)=>e.jsx(ze,{ref:i,className:w("-mx-1 my-1 h-px bg-muted",t),...l}));Es.displayName=ze.displayName;async function Ps(t=50){if(C())return await _(`/threads?limit=${encodeURIComponent(String(t))}`);{const{data:l,error:i}=await f.from("threads").select("*").order("created_at",{ascending:!1}).limit(t);if(i)throw i;return l}}async function Gs(t,l){if(!t.trim()&&!l)throw new Error("El contenido no puede estar vacÃ­o");if(t.length>500)throw new Error("El contenido no puede exceder 500 caracteres");if(C()){let i=null;if(l){if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(l.type))throw new Error("Solo se permiten imÃ¡genes (JPG, PNG, GIF, WEBP)");const j=5*1024*1024;if(l.size>j)throw new Error("La imagen no puede superar 5MB");i=await ds(l)}return await _("/threads",{method:"POST",body:JSON.stringify({content:t.trim(),image_url:i})})}else{const{data:i}=await f.auth.getUser(),m=i.user?.id;if(!m)throw new Error("No autenticado");let d=null;if(l){if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(l.type))throw new Error("Solo se permiten imÃ¡genes (JPG, PNG, GIF, WEBP)");const g=5*1024*1024;if(l.size>g)throw new Error("La imagen no puede superar 5MB");const S=l.name.split(".").pop(),N=`${m}/${crypto.randomUUID()}.${S||"jpg"}`,{error:G}=await f.storage.from("thread-images").upload(N,l,{upsert:!1,cacheControl:"3600"});if(G)throw G;const{data:M}=f.storage.from("thread-images").getPublicUrl(N);d=M.publicUrl}const{data:j,error:p}=await f.from("threads").insert({author_id:m,content:t,image_url:d}).select("*").single();if(p)throw p;return j}}async function ks(t){if(C())return await _(`/threads/${encodeURIComponent(t)}/comments`);{const{data:l,error:i}=await f.from("thread_comments").select("*").eq("thread_id",t).order("created_at",{ascending:!0});if(i)throw i;return l}}async function Us(t,l){if(C())return await _(`/threads/${encodeURIComponent(t)}/comments`,{method:"POST",body:JSON.stringify({content:l})});{const{data:i}=await f.auth.getUser(),m=i.user?.id;if(!m)throw new Error("No autenticado");const{data:d,error:j}=await f.from("thread_comments").insert({thread_id:t,author_id:m,content:l}).select("*").single();if(j)throw j;return d}}async function Ds(t){if(C())await _(`/threads/${encodeURIComponent(t)}`,{method:"DELETE"});else{const{error:l}=await f.from("threads").delete().eq("id",t);if(l)throw l}}function zs(t){return t?"franciscolorenzo2406@gmail.com".split(",").map(i=>i.trim().toLowerCase()).filter(Boolean).includes(t.toLowerCase()):!1}const Hs=()=>{const[t,l]=n.useState([]),[i,m]=n.useState([]),[d,j]=n.useState(""),[p,P]=n.useState("all"),[g,S]=n.useState("public"),[N,G]=n.useState("name"),[M,Be]=n.useState(!0),[T,Le]=n.useState(""),[V,Ae]=n.useState("personas"),[Fe,J]=n.useState([]),[b,re]=n.useState(""),[O,q]=n.useState(null),[le,H]=n.useState(null),[ie,ne]=n.useState(!1),[oe,$e]=n.useState(null),[ce,de]=n.useState([]),[W,me]=n.useState(""),[Me,Ve]=n.useState(""),[ue,Je]=n.useState([]),[Oe,k]=n.useState(!1),[y,Q]=n.useState(""),[E,X]=n.useState(""),[qe,U]=n.useState(null),[he,D]=n.useState(null),[xe,pe]=n.useState(!1),z=Ss(),{toast:u}=ms();n.useEffect(()=>{(async()=>{try{const s=await us();if(!s){z("/auth");return}Le(s.id),Ve(s.email||"");let a=[];if(C())a=(await _("/profiles/directory?q=&limit=200&offset=0")).map(r=>({user_id:String(r.user_id),nombre_completo:r.nombre_completo??null,avatar_url:r.avatar_url??null,edad:r.edad??null,is_public:r.is_public??null,username:r.username??null}));else{const{data:o,error:r}=await f.rpc("list_profiles_directory");let c=o;if(r){const{data:v,error:je}=await f.from("profiles").select("user_id, nombre_completo, avatar_url, edad, is_public").order("nombre_completo",{ascending:!0});if(je)throw je;c=v}a=(c||[]).map(v=>({user_id:String(v.user_id),nombre_completo:v.nombre_completo??null,avatar_url:v.avatar_url??null,edad:v.edad??null,is_public:v.is_public??null,username:v.username??null}))}l(a),m(a)}catch(s){console.error("Error cargando usuarios:",s)}finally{Be(!1)}})()},[]),n.useEffect(()=>{(async()=>{try{const a=(await Ps(50)).map(o=>{const r=t.find(c=>c.user_id===o.author_id);return{...o,author_name:r?.nombre_completo,author_username:r?.username,author_avatar:r?.avatar_url}});J(a)}catch(s){console.error("Error cargando hilos:",s)}})()},[t]),n.useEffect(()=>{V==="grupos"&&I()},[V]);const I=async()=>{try{const s=await Ns();Je(s)}catch(s){console.error("Error cargando grupos:",s)}};n.useEffect(()=>{if(!d.trim()&&p==="all"&&g==="all"){ge(t);return}let s=t;if(d.trim()){const a=d.toLowerCase();s=s.filter(o=>o.nombre_completo?.toLowerCase().includes(a))}p!=="all"&&(s=s.filter(a=>R(a.edad)===p)),g==="public"?s=s.filter(a=>a.is_public===!0):g==="private"&&(s=s.filter(a=>a.is_public!==!0)),ge(s)},[d,p,g,N,t]);const ge=s=>{const a=[...s];N==="name"?a.sort((o,r)=>(o.nombre_completo||"").localeCompare(r.nombre_completo||"")):N==="age-asc"?a.sort((o,r)=>(o.edad||0)-(r.edad||0)):N==="age-desc"?a.sort((o,r)=>(r.edad||0)-(o.edad||0)):N==="rama"&&a.sort((o,r)=>{const c={Manada:1,Tropa:2,Pionero:3,Rover:4,Adulto:5,Scout:6};return(c[R(o.edad)]||99)-(c[R(r.edad)]||99)}),m(a)},He=async()=>{if(!(!b.trim()&&!O)){if(b.length>500){u({title:"Contenido muy largo",description:"El hilo no puede exceder 500 caracteres",variant:"destructive"});return}try{ne(!0);const s=await Gs(b.trim(),O||void 0),a=t.find(r=>r.user_id===T),o={...s,author_name:a?.nombre_completo,author_username:a?.username,author_avatar:a?.avatar_url};J(r=>[o,...r]),re(""),q(null),H(null),u({title:"Hilo publicado",description:"Tu hilo se ha publicado correctamente"})}catch(s){u({title:"Error",description:s.message||"No se pudo publicar el hilo",variant:"destructive"})}finally{ne(!1)}}},We=s=>{const a=s.target.files?.[0];if(a){if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(a.type)){u({title:"Tipo de archivo no vÃ¡lido",description:"Solo se permiten imÃ¡genes (JPG, PNG, GIF, WEBP)",variant:"destructive"});return}const r=5*1024*1024;if(a.size>r){u({title:"Archivo muy grande",description:"La imagen no puede superar 5MB",variant:"destructive"});return}q(a);const c=new FileReader;c.onloadend=()=>{H(c.result)},c.readAsDataURL(a)}},Qe=()=>{q(null),H(null)},Xe=async s=>{$e(s);try{const a=await ks(s);de(a)}catch(a){console.error(a)}},fe=async()=>{if(!(!oe||!W.trim()))try{const s=await Us(oe,W.trim());de(a=>[...a,s]),me("")}catch(s){console.error(s)}},Ye=async s=>{if(confirm("Â¿EstÃ¡s seguro de eliminar este hilo?"))try{await Ds(s),J(a=>a.filter(o=>o.id!==s)),u({title:"Hilo eliminado",description:"El hilo se eliminÃ³ correctamente"})}catch(a){u({title:"Error",description:a.message,variant:"destructive"})}},Ze=s=>{const a=s.target.files?.[0];if(a){if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(a.type)){u({title:"Tipo de archivo no vÃ¡lido",description:"Solo se permiten imÃ¡genes (JPG, PNG, GIF, WEBP)",variant:"destructive"});return}const r=5*1024*1024;if(a.size>r){u({title:"Archivo muy grande",description:"La imagen no puede superar 5MB",variant:"destructive"});return}U(a);const c=new FileReader;c.onloadend=()=>{D(c.result)},c.readAsDataURL(a)}},Ke=async()=>{if(!y.trim()){u({title:"Campo requerido",description:"El nombre del grupo es obligatorio",variant:"destructive"});return}try{pe(!0),await bs(y.trim(),E.trim()||null,qe||void 0),u({title:"Grupo creado",description:"El grupo se ha creado correctamente"}),Q(""),X(""),U(null),D(null),k(!1),await I()}catch(s){u({title:"Error",description:s.message||"No se pudo crear el grupo",variant:"destructive"})}finally{pe(!1)}},es=async s=>{try{await ys(s),u({title:"Te has unido al grupo",description:"Ahora eres miembro de este grupo"}),await I()}catch(a){u({title:"Error",description:a.message,variant:"destructive"})}},ss=async s=>{if(confirm("Â¿EstÃ¡s seguro de que quieres salir de este grupo?"))try{await ws(s),u({title:"Has salido del grupo",description:"Ya no eres miembro de este grupo"}),await I()}catch(a){u({title:"Error",description:a.message,variant:"destructive"})}},R=s=>s?s>=21?"Adulto":s>=18?"Rover":s>=15?"Pionero":s>=11?"Tropa":s>=7?"Manada":"Scout":"Scout";return M?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"h-20"}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})})]}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"h-16 sm:h-20"}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-6 sm:py-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(rs,{className:"w-8 h-8 text-primary"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:"Comuni 7"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Personas y hilos de la comunidad"})]})]}),e.jsxs(Cs,{value:V,onValueChange:Ae,className:"w-full",children:[e.jsxs(_s,{className:"mb-6",children:[e.jsx(ee,{value:"personas",children:"Personas"}),e.jsx(ee,{value:"hilos",children:"Hilos"}),e.jsx(ee,{value:"grupos",children:"Grupos"})]}),e.jsxs(se,{value:"personas",children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx(ls,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),e.jsx(Z,{type:"text",placeholder:"Buscar por nombre...",value:d,onChange:s=>j(s.target.value),className:"pl-10 h-12"})]}),e.jsxs("div",{className:"grid gap-3 sm:grid-cols-3 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block text-muted-foreground",children:"Rama"}),e.jsxs(ae,{value:p,onValueChange:P,children:[e.jsx(F,{className:"w-full",children:e.jsx(te,{placeholder:"Todas las ramas"})}),e.jsxs($,{children:[e.jsx(x,{value:"all",children:"Todas las ramas"}),e.jsx(x,{value:"Manada",children:"ðŸº Manada (7-10 aÃ±os)"}),e.jsx(x,{value:"Tropa",children:"â›º Tropa (11-14 aÃ±os)"}),e.jsx(x,{value:"Pionero",children:"ðŸ•ï¸ Pioneros (15-17 aÃ±os)"}),e.jsx(x,{value:"Rover",children:"ðŸŽ’ Rovers (18-20 aÃ±os)"}),e.jsx(x,{value:"Adulto",children:"ðŸ‘¤ Adultos (21+ aÃ±os)"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block text-muted-foreground",children:"Privacidad"}),e.jsxs(ae,{value:g,onValueChange:S,children:[e.jsx(F,{className:"w-full",children:e.jsx(te,{placeholder:"Todos los perfiles"})}),e.jsxs($,{children:[e.jsx(x,{value:"all",children:"Todos los perfiles"}),e.jsx(x,{value:"public",children:"ðŸŒ Solo pÃºblicos"}),e.jsx(x,{value:"private",children:"ðŸ”’ Solo privados"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block text-muted-foreground",children:"Ordenar por"}),e.jsxs(ae,{value:N,onValueChange:G,children:[e.jsx(F,{className:"w-full",children:e.jsx(te,{placeholder:"Nombre"})}),e.jsxs($,{children:[e.jsx(x,{value:"name",children:"Nombre (A-Z)"}),e.jsx(x,{value:"age-asc",children:"Edad (menor a mayor)"}),e.jsx(x,{value:"age-desc",children:"Edad (mayor a menor)"}),e.jsx(x,{value:"rama",children:"Rama (Manada â†’ Adulto)"})]})]})]})]}),(p!=="all"||g!=="all"||d)&&e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(is,{className:"w-4 h-4"}),e.jsx("span",{children:"Filtros activos:"})]}),d&&e.jsxs(K,{variant:"secondary",className:"gap-1",children:['BÃºsqueda: "',d,'"',e.jsx("button",{onClick:()=>j(""),className:"ml-1 hover:text-destructive",children:"Ã—"})]}),p!=="all"&&e.jsxs(K,{variant:"secondary",className:"gap-1",children:[p,e.jsx("button",{onClick:()=>P("all"),className:"ml-1 hover:text-destructive",children:"Ã—"})]}),g!=="all"&&e.jsxs(K,{variant:"secondary",className:"gap-1",children:[g==="public"?"ðŸŒ PÃºblicos":"ðŸ”’ Privados",e.jsx("button",{onClick:()=>S("all"),className:"ml-1 hover:text-destructive",children:"Ã—"})]}),(p!=="all"||g!=="all"||d)&&e.jsx(h,{size:"sm",variant:"ghost",onClick:()=>{j(""),P("all"),S("all")},className:"h-6 text-xs",children:"Limpiar todo"})]}),e.jsx("div",{className:"mb-6 text-sm text-muted-foreground",children:i.length===t.length?e.jsxs("p",{children:[t.length," ",t.length===1?"scout":"scouts"," en total"]}):e.jsxs("p",{children:[i.length," ",i.length===1?"resultado":"resultados"," de ",t.length]})}),i.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"No se encontraron scouts."})}):e.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:i.map(s=>{const a=s.user_id===T;return e.jsx(B,{className:"hover:shadow-lg transition-shadow",children:e.jsx(L,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(A,{avatarUrl:s.avatar_url,userName:s.nombre_completo,size:"lg",className:"w-16 h-16 text-xl flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold truncate",children:s.nombre_completo||"Scout"}),a&&e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-primary text-primary-foreground",children:"TÃº"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-3",children:[e.jsx("span",{children:R(s.edad)}),s.edad&&e.jsxs("span",{children:["â€¢ ",s.edad," aÃ±os"]})]}),e.jsx("div",{className:"flex items-center gap-2 mb-3",children:s.is_public?e.jsx("span",{className:"text-xs px-2 py-1 rounded-md bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300",children:"ðŸŒ PÃºblico"}):e.jsx("span",{className:"text-xs px-2 py-1 rounded-md bg-muted text-muted-foreground",children:"ðŸ”’ Privado"})}),a?e.jsx(h,{size:"sm",variant:"outline",className:"w-full",onClick:()=>z("/perfil"),children:"Ver mi perfil"}):e.jsx(h,{size:"sm",className:"w-full",onClick:()=>z(`/perfil-public/${s.user_id}`),children:"Ver perfil"})]})]})})},s.user_id)})})]}),e.jsxs(se,{value:"hilos",children:[e.jsx(B,{className:"mb-6",children:e.jsx(L,{className:"p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(A,{avatarUrl:t.find(s=>s.user_id===T)?.avatar_url||null,userName:t.find(s=>s.user_id===T)?.nombre_completo||null,size:"md",className:"flex-shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsx(Se,{placeholder:"Â¿QuÃ© estÃ¡ pasando?",value:b,onChange:s=>re(s.target.value),className:"min-h-[100px] resize-none border-0 focus-visible:ring-0 p-0 text-base",maxLength:500}),b.length>0&&e.jsxs("div",{className:`text-xs text-right ${b.length>450?"text-destructive font-semibold":"text-muted-foreground"}`,children:[b.length,"/500"]}),le&&e.jsxs("div",{className:"relative inline-block",children:[e.jsx("img",{src:le,alt:"Preview",className:"rounded-xl max-h-64 object-cover border"}),e.jsx(h,{variant:"destructive",size:"icon",className:"absolute top-2 right-2 h-8 w-8 rounded-full",onClick:Qe,children:e.jsx(ve,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t",children:[e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:We,className:"hidden"}),e.jsxs("div",{className:"flex items-center gap-2 text-primary hover:bg-primary/10 px-3 py-2 rounded-full transition-colors",children:[e.jsx(Ne,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Imagen"})]})]}),e.jsx(h,{onClick:He,disabled:ie||!b.trim()&&!O,className:"rounded-full px-6",children:ie?"Publicando...":"Publicar"})]})]})]})})}),e.jsx("div",{className:"space-y-4",children:Fe.map(s=>{const o=s.author_id===T||zs(Me);return e.jsx(B,{className:"hover:bg-muted/30 transition-colors",children:e.jsx(L,{className:"p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(A,{avatarUrl:s.author_avatar||null,userName:s.author_name||null,size:"md",className:"flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-semibold hover:underline cursor-pointer",children:s.author_name||"Scout"}),s.author_username&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:["@",s.author_username]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Â· ",new Date(s.created_at).toLocaleDateString("es-ES",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),o&&e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>Ye(s.id),className:"h-8 w-8 p-0 text-muted-foreground hover:text-destructive hover:bg-destructive/10",children:e.jsx(ns,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"text-base whitespace-pre-wrap mb-3",children:s.content}),s.image_url&&e.jsx("div",{className:"rounded-xl border overflow-hidden mb-3",children:e.jsx("img",{src:s.image_url,alt:"imagen del hilo",className:"w-full max-h-96 object-cover"})}),e.jsxs(be,{children:[e.jsx(we,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>Xe(s.id),className:"text-muted-foreground hover:text-primary",children:"ðŸ’¬ Comentarios"})}),e.jsxs(ye,{className:"sm:max-w-lg",children:[e.jsx(Ce,{children:e.jsx(_e,{children:"Comentarios"})}),e.jsx("div",{className:"space-y-3 max-h-[50vh] overflow-auto",children:ce.length===0?e.jsx("div",{className:"text-sm text-muted-foreground text-center py-8",children:"SÃ© el primero en comentar"}):ce.map(r=>{const c=t.find(v=>v.user_id===r.author_id);return e.jsxs("div",{className:"flex gap-3 border-b pb-3 last:border-0",children:[e.jsx(A,{avatarUrl:c?.avatar_url||null,userName:c?.nombre_completo||null,size:"sm",className:"flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-medium text-sm",children:c?.nombre_completo||"Scout"}),c?.username&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["@",c.username]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Â· ",new Date(r.created_at).toLocaleDateString("es-ES",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),e.jsx("div",{className:"text-sm",children:r.content})]})]},r.id)})}),e.jsxs("div",{className:"flex gap-2 pt-2 border-t",children:[e.jsx(Z,{placeholder:"Escribe un comentario",value:W,onChange:r=>me(r.target.value),onKeyDown:r=>{r.key==="Enter"&&(r.preventDefault(),fe())}}),e.jsx(h,{onClick:fe,children:"Enviar"})]})]})]})]})]})})},s.id)})})]}),e.jsxs(se,{value:"grupos",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Grupos de la comunidad"}),e.jsxs(be,{open:Oe,onOpenChange:k,children:[e.jsx(we,{asChild:!0,children:e.jsxs(h,{className:"gap-2",children:[e.jsx(Y,{className:"h-4 w-4"}),"Crear Grupo"]})}),e.jsxs(ye,{className:"sm:max-w-md",children:[e.jsx(Ce,{children:e.jsx(_e,{children:"Crear nuevo grupo"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Nombre del grupo *"}),e.jsx(Z,{placeholder:"Ej: Patrulla Ãguila",value:y,onChange:s=>Q(s.target.value),maxLength:100}),y.length>90&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:[100-y.length," caracteres restantes"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"DescripciÃ³n"}),e.jsx(Se,{placeholder:"Describe de quÃ© trata el grupo...",value:E,onChange:s=>X(s.target.value),maxLength:500,className:"min-h-[100px]"}),E.length>450&&e.jsxs("p",{className:`text-xs ${E.length>480?"text-destructive":"text-muted-foreground"}`,children:[500-E.length," caracteres restantes"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Imagen de portada"}),he?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:he,alt:"Preview",className:"w-full h-32 object-cover rounded-lg"}),e.jsx(h,{variant:"destructive",size:"icon",className:"absolute top-2 right-2 h-8 w-8 rounded-full",onClick:()=>{U(null),D(null)},children:e.jsx(ve,{className:"h-4 w-4"})})]}):e.jsxs("label",{className:"cursor-pointer",children:[e.jsxs("div",{className:"border-2 border-dashed rounded-lg p-8 text-center hover:bg-muted/50 transition-colors",children:[e.jsx(Ne,{className:"h-8 w-8 mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Click para subir imagen"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"JPG, PNG, GIF o WEBP (mÃ¡x. 5MB)"})]}),e.jsx("input",{type:"file",accept:"image/*",onChange:Ze,className:"hidden"})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx(h,{onClick:Ke,disabled:xe||!y.trim(),className:"flex-1",children:xe?"Creando...":"Crear Grupo"}),e.jsx(h,{variant:"outline",onClick:()=>{k(!1),Q(""),X(""),U(null),D(null)},children:"Cancelar"})]})]})]})]})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[ue.map(s=>{const a=!!s.user_role,o=s.user_role==="owner",r=s.user_role==="admin";return e.jsxs(B,{className:"overflow-hidden hover:shadow-lg transition-shadow",children:[s.cover_image&&e.jsx("div",{className:"h-32 overflow-hidden",children:e.jsx("img",{src:s.cover_image,alt:s.name,className:"w-full h-full object-cover"})}),e.jsxs(L,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.name}),o&&e.jsx(os,{className:"h-5 w-5 text-yellow-500 flex-shrink-0"}),r&&!o&&e.jsx(cs,{className:"h-5 w-5 text-blue-500 flex-shrink-0"})]}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground mb-3 line-clamp-2",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:[s.member_count," ",s.member_count===1?"miembro":"miembros"]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(s.created_at).toLocaleDateString("es-ES",{month:"short",year:"numeric"})})]}),e.jsx("div",{className:"flex gap-2",children:a?e.jsxs(e.Fragment,{children:[e.jsx(h,{size:"sm",className:"flex-1",onClick:()=>z(`/grupos/${s.id}`),children:"Abrir"}),!o&&e.jsx(h,{size:"sm",variant:"outline",onClick:()=>ss(s.id),children:"Salir"})]}):e.jsxs(h,{size:"sm",className:"flex-1 gap-2",onClick:()=>es(s.id),children:[e.jsx(Y,{className:"h-4 w-4"}),"Unirse"]})})]})]},s.id)}),ue.length===0&&e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"No hay grupos aÃºn"}),e.jsxs(h,{onClick:()=>k(!0),className:"gap-2",children:[e.jsx(Y,{className:"h-4 w-4"}),"Crear el primer grupo"]})]})]})]})]})]})]})};export{Hs as default};
