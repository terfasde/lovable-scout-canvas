import{r,j as e,ab as G,q as X,g as Y,X as J}from"./vendor-react-BgpSLK3q.js";import{c as U,u as K,g as Q,B as n,U as p,s as Z,D as k,d as E,f as z,h as F}from"./index-CQXDJ8Au.js";import{a as q,d as ee}from"./api-CpQ31Ffz.js";import{A as se,a as te,b as ae,c as le,d as re,e as ie,f as oe,g as ne,h as me}from"./alert-dialog-DlB5ihTY.js";import{z as P,B as ce,E as de,G as R,H as xe}from"./vendor-radix-B3dsqebR.js";import{g as ue,a as fe,b as pe,c as he,d as ge,e as je,r as Ne}from"./follows-w7rB7DGA.js";import{k as we}from"./vendor-MRMtI2Il.js";import"./vendor-supabase-DQanAYxp.js";import"./vendor-router-VbqrkW3a.js";import"./vendor-style--X5BZniO.js";import"./vendor-query-DDnmq2va.js";const N=r.forwardRef(({className:u,children:m,...t},f)=>e.jsxs(P,{ref:f,className:U("relative overflow-hidden",u),...t,children:[e.jsx(ce,{className:"h-full w-full rounded-[inherit]",children:m}),e.jsx(O,{}),e.jsx(de,{})]}));N.displayName=P.displayName;const O=r.forwardRef(({className:u,orientation:m="vertical",...t},f)=>e.jsx(R,{ref:f,orientation:m,className:U("flex touch-none select-none transition-colors",m==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",m==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",u),...t,children:e.jsx(xe,{className:"relative flex-1 rounded-full bg-border"})}));O.displayName=R.displayName;const Fe=()=>{const[u,m]=r.useState(!0),[t,f]=r.useState(null),[w,T]=r.useState(""),[b,h]=r.useState([]),[x,L]=r.useState(""),[M,v]=r.useState(0),[B,I]=r.useState(0),[g,_]=r.useState(!1),[j,y]=r.useState(!1),[S,V]=r.useState([]),[C,$]=r.useState([]),[H,A]=r.useState(!1),c=we(),{toast:d}=K();r.useEffect(()=>{(async()=>{try{const s=await Q();if(!s){c("/auth");return}L(s.id),T(s.email||"");const l=await q(s.id).catch(()=>null),{data:a}=await ue();h(a?a.map(o=>({follower_id:String(o.follower_id),created_at:String(o.created_at),follower:o.follower?{id:String(o.follower.user_id||o.follower.id),nombre_completo:o.follower.nombre_completo??null,avatar_url:o.follower.avatar_url??null,username:o.follower.username??null}:void 0})):[]);const[{count:i},{count:W}]=await Promise.all([fe(s.id),pe(s.id)]);v(i||0),I(W||0),f(l??null)}catch(s){d({title:"Error",description:s?.message||"No se pudo cargar el perfil",variant:"destructive"})}finally{m(!1)}})()},[]),r.useEffect(()=>{(async()=>{try{if(g&&x){const{data:s,error:l}=await he(x,0,49);l||V((s||[]).map(a=>({follower_id:String(a.follower_id),created_at:String(a.created_at),follower:a.follower?{id:String(a.follower.user_id||a.follower.id),nombre_completo:a.follower.nombre_completo??null,avatar_url:a.follower.avatar_url??null,username:a.follower.username??null}:void 0})))}}catch{}})()},[g,x]),r.useEffect(()=>{(async()=>{try{if(j&&x){const{data:s,error:l}=await ge(x,0,49);l||$((s||[]).map(a=>({followed_id:String(a.followed_id),created_at:String(a.created_at),followed:a.followed?{id:String(a.followed.user_id||a.followed.id),nombre_completo:a.followed.nombre_completo??null,avatar_url:a.followed.avatar_url??null,username:a.followed.username??null}:void 0})))}}catch{}})()},[j,x]);const D=s=>s?s>=21?"Adulto":s>=18?"Rover":s>=15?"Pionero":s>=11?"Tropa":s>=7?"Manada":"No especificada":"No especificada";return u?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"h-20"}),e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})})]}):t?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"h-16 sm:h-20"}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-6 sm:py-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:items-start gap-6 sm:gap-8 mb-6 sm:mb-8 pb-6 sm:pb-8 border-b",children:[e.jsx(p,{avatarUrl:t.avatar_url,userName:t.nombre_completo,size:"xl",className:"w-24 h-24 sm:w-32 sm:h-32 md:w-40 md:h-40 text-3xl sm:text-4xl"}),e.jsxs("div",{className:"flex-1 min-w-0 w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:items-start gap-3 sm:gap-4 mb-4 flex-wrap",children:[e.jsxs("div",{className:"flex flex-col items-center sm:items-start",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-normal",children:t.nombre_completo||"Usuario Scout"}),t.username&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["@",t.username]})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>c("/perfil/editar"),className:"gap-1 flex-1 sm:flex-none text-xs sm:text-sm",children:[e.jsx(G,{className:"w-3 h-3 sm:w-4 sm:h-4"}),e.jsx("span",{className:"hidden xs:inline",children:"Editar perfil"}),e.jsx("span",{className:"xs:hidden",children:"Editar"})]}),e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>c("/perfil/compartir"),className:"gap-1 flex-1 sm:flex-none text-xs sm:text-sm",children:[e.jsx(X,{className:"w-3 h-3 sm:w-4 sm:h-4"}),e.jsx("span",{className:"hidden xs:inline",children:"Compartir"}),e.jsx("span",{className:"xs:hidden",children:"Compartir"})]}),e.jsxs(se,{children:[e.jsx(te,{asChild:!0,children:e.jsx(n,{variant:"destructive",size:"sm",className:"gap-1 flex-1 sm:flex-none text-xs sm:text-sm",disabled:H,children:"Eliminar cuenta"})}),e.jsxs(ae,{children:[e.jsxs(le,{children:[e.jsx(re,{children:"Â¿Eliminar tu cuenta?"}),e.jsx(ie,{children:"Esta acciÃ³n eliminarÃ¡ tu usuario y todos los datos asociados (perfil, follows, grupos, DMs, hilos) en el backend local. No podrÃ¡s deshacerlo."})]}),e.jsxs(oe,{children:[e.jsx(ne,{children:"Cancelar"}),e.jsx(me,{onClick:async()=>{try{A(!0),await ee();try{localStorage.removeItem("local_api_token")}catch{}try{await Z.auth.signOut()}catch{}d({title:"Cuenta eliminada"}),c("/auth")}catch(s){d({title:"Error",description:s?.message||"No se pudo eliminar la cuenta",variant:"destructive"})}finally{A(!1)}},children:"SÃ­, eliminar"})]})]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-6 sm:gap-8 mb-4 justify-center sm:justify-start",children:[e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("span",{className:"font-semibold text-sm sm:text-base",children:t.edad||"0"}),e.jsx("span",{className:"text-muted-foreground ml-1 text-xs sm:text-sm",children:"aÃ±os"})]}),e.jsxs("div",{className:"text-center sm:text-left",children:[e.jsx("span",{className:"font-semibold text-sm sm:text-base",children:D(t.edad)}),e.jsx("span",{className:"text-muted-foreground ml-1 text-xs sm:text-sm",children:"Rama"})]}),e.jsxs("button",{type:"button",onClick:()=>_(!0),className:"text-center sm:text-left hover:text-primary transition-colors",children:[e.jsx("span",{className:"font-semibold text-sm sm:text-base",children:M}),e.jsx("span",{className:"text-muted-foreground ml-1 text-xs sm:text-sm",children:"Seguidores"})]}),e.jsxs("button",{type:"button",onClick:()=>y(!0),className:"text-center sm:text-left hover:text-primary transition-colors",children:[e.jsx("span",{className:"font-semibold text-sm sm:text-base",children:B}),e.jsx("span",{className:"text-muted-foreground ml-1 text-xs sm:text-sm",children:"Siguiendo"})]})]}),e.jsxs("div",{className:"space-y-1 text-center sm:text-left",children:[e.jsx("p",{className:"font-semibold text-sm sm:text-base",children:t.nombre_completo}),w&&e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:w}),t.telefono&&e.jsxs("p",{className:"text-xs sm:text-sm text-muted-foreground",children:["ğŸ“ ",t.telefono]}),t.rol_adulto&&t.edad&&t.edad>=21&&e.jsxs("p",{className:"text-xs sm:text-sm",children:["ğŸ‘¤ ",t.rol_adulto]})]})]})]}),e.jsxs("div",{className:"grid gap-4 sm:gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsx("h2",{className:"text-base sm:text-lg font-semibold",children:"InformaciÃ³n Scout"}),(t.seisena||t.edad&&t.edad>=7&&t.edad<=20)&&e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 sm:p-4",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-muted-foreground mb-1",children:"Manada"}),e.jsx("p",{className:"text-sm sm:text-base",children:t.seisena||"No especificada"})]}),(t.patrulla||t.edad&&t.edad>=11&&t.edad<=20)&&e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 sm:p-4",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-muted-foreground mb-1",children:"Tropa"}),e.jsx("p",{className:"text-sm sm:text-base",children:t.patrulla||"No especificada"})]}),(t.equipo_pioneros||t.edad&&t.edad>=15&&t.edad<=20)&&e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 sm:p-4",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-muted-foreground mb-1",children:"Pioneros"}),e.jsx("p",{className:"text-sm sm:text-base",children:t.equipo_pioneros||"No especificado"})]}),(t.comunidad_rovers||t.edad&&t.edad>=18&&t.edad<=20)&&e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 sm:p-4",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-muted-foreground mb-1",children:"Rovers"}),e.jsx("p",{className:"text-sm sm:text-base",children:t.comunidad_rovers||"No especificada"})]})]}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsx("h2",{className:"text-base sm:text-lg font-semibold",children:"Detalles"}),t.fecha_nacimiento&&e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 sm:p-4",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-muted-foreground mb-1",children:"Fecha de nacimiento"}),e.jsx("p",{className:"text-sm sm:text-base",children:new Date(t.fecha_nacimiento).toLocaleDateString("es-UY")})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 sm:p-4",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-muted-foreground mb-1",children:"Rama actual"}),e.jsx("p",{className:"text-sm sm:text-base font-medium",children:D(t.edad)})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 sm:p-4",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-muted-foreground mb-1",children:"Perfil"}),e.jsx("p",{className:"text-sm sm:text-base",children:t.is_public?"ğŸŒ PÃºblico":"ğŸ”’ Privado"})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 sm:p-4",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-muted-foreground mb-2",children:"Solicitudes de seguimiento"}),b.length===0?e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"No tienes solicitudes."}):e.jsx("ul",{className:"space-y-2",children:b.map(s=>e.jsxs("li",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(p,{avatarUrl:s.follower?.avatar_url,userName:s.follower?.nombre_completo,size:"sm",className:"w-8 h-8 flex-shrink-0"}),e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsx("span",{className:"text-sm font-medium truncate",children:s.follower?.nombre_completo||"Usuario"}),s.follower?.username&&e.jsxs("span",{className:"text-xs text-muted-foreground truncate",children:["@",s.follower.username]})]})]}),e.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[e.jsxs(n,{size:"sm",variant:"default",className:"gap-1",onClick:async()=>{const{error:l}=await je(s.follower_id);if(l)return d({title:"Error",description:l.message||"No se pudo aceptar",variant:"destructive"});h(a=>a.filter(i=>i.follower_id!==s.follower_id)),v(a=>a+1),d({title:"Solicitud aceptada"})},children:[e.jsx(Y,{className:"w-4 h-4"})," Aceptar"]}),e.jsxs(n,{size:"sm",variant:"outline",className:"gap-1",onClick:async()=>{const{error:l}=await Ne(s.follower_id);if(l)return d({title:"Error",description:l.message||"No se pudo rechazar",variant:"destructive"});h(a=>a.filter(i=>i.follower_id!==s.follower_id)),d({title:"Solicitud rechazada"})},children:[e.jsx(J,{className:"w-4 h-4"})," Rechazar"]})]})]},s.follower_id))})]})]})]})]}),e.jsx(k,{open:g,onOpenChange:s=>_(s),children:e.jsxs(E,{className:"sm:max-w-md",children:[e.jsx(z,{children:e.jsx(F,{children:"Seguidores"})}),e.jsx(N,{className:"max-h-[60vh] pr-3",children:e.jsxs("ul",{className:"space-y-3",children:[S.length===0&&e.jsx("li",{className:"text-sm text-muted-foreground",children:"No tienes seguidores aÃºn."}),S.map(s=>{const l=s.follower,a=l?.nombre_completo||`Usuario ${s.follower_id.slice(0,8)}â€¦`,i=l?.username;return e.jsxs("li",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx(p,{avatarUrl:l?.avatar_url||void 0,userName:a,size:"sm"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:a}),i&&e.jsxs("p",{className:"text-xs text-muted-foreground truncate",children:["@",i]})]})]}),e.jsx(n,{variant:"outline",size:"sm",onClick:()=>c(`/perfil-public/${s.follower_id}`),children:"Ver perfil"})]},s.follower_id)})]})})]})}),e.jsx(k,{open:j,onOpenChange:s=>y(s),children:e.jsxs(E,{className:"sm:max-w-md",children:[e.jsx(z,{children:e.jsx(F,{children:"Siguiendo"})}),e.jsx(N,{className:"max-h-[60vh] pr-3",children:e.jsxs("ul",{className:"space-y-3",children:[C.length===0&&e.jsx("li",{className:"text-sm text-muted-foreground",children:"AÃºn no sigues a nadie."}),C.map(s=>{const l=s.followed,a=l?.nombre_completo||`Usuario ${s.followed_id.slice(0,8)}â€¦`,i=l?.username;return e.jsxs("li",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx(p,{avatarUrl:l?.avatar_url||void 0,userName:a,size:"sm"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:a}),i&&e.jsxs("p",{className:"text-xs text-muted-foreground truncate",children:["@",i]})]})]}),e.jsx(n,{variant:"outline",size:"sm",onClick:()=>c(`/perfil-public/${s.followed_id}`),children:"Ver perfil"})]},s.followed_id)})]})})]})})]}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"h-20"}),e.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"No se encontrÃ³ perfil."}),e.jsx(n,{onClick:()=>c("/perfil/editar"),children:"Crear perfil"})]})]})};export{Fe as default};
